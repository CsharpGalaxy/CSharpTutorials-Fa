
## ููุฑุณุช ูุทุงูุจ

1. [ููุฏูู: Defensive Copying ฺุณุชุ](#1-ููุฏูู-defensive-copying-ฺุณุช)
2. [ฺุฑุง Defensive Copying ููู ุงุณุชุ](#2-ฺุฑุง-defensive-copying-ููู-ุงุณุช)
3. [ูุซุงูโูุง ุงุฒ ูุดฺฉูุงุช ุจุฏูู Defensive Copying](#3-ูุซุงููุง-ุงุฒ-ูุดฺฉูุงุช-ุจุฏูู-defensive-copying)
4. [ฺฺฏููู ุฏุฑ C# ุงุฒ Defensive Copying ุงุณุชูุงุฏู ฺฉููุ](#4-ฺฺฏููู-ุฏุฑ-c-ุงุฒ-defensive-copying-ุงุณุชูุงุฏู-ฺฉูู)
5. [ุชูุงูุช ุจู Deep Copy ู Shallow Copy](#5-ุชูุงูุช-ุจู-deep-copy-ู-shallow-copy)
6. [ุจูุชุฑู ุฑูุดโูุง (Best Practices)](#6-ุจูุชุฑู-ุฑูุดูุง-best-practices)
7. [ูุญุฏูุฏุชโูุง ู ูุฒููโูุง](#7-ูุญุฏูุฏุชูุง-ู-ูุฒูููุง)
8. [ุฌูุนโุจูุฏ](#8-ุฌูุนุจูุฏ)
9. [ููุงุจุน ูุนุชุจุฑ](#9-ููุงุจุน-ูุนุชุจุฑ)

---

## 1. ููุฏูู: Defensive Copying ฺุณุชุ

**Defensive Copying** ฺฉ ุชฺฉูฺฉ ุงููุช ุฏุฑ ุจุฑูุงููโููุณ ุดุกโฺฏุฑุง ุงุณุช ฺฉู ุจุง ูุฏู **ูุญุงูุธุช ุงุฒ ุณูุงูุช (Integrity) ฺฉ ุดุก** ุฏุฑ ุจุฑุงุจุฑ ุชุบุฑุงุช ุบุฑููุชุธุฑู ุงุฒ ุจุฑูู ุทุฑุงุญ ุดุฏู ุงุณุช.

ููุช ฺฉ ุดุก ุฏุงุฏูโูุง (ูุซู ุขุฑุงูโูุงุ ูุณุชโูุง ุง ุณุงุฑ ุงุดุงุก ูุงุจู ุชุบุฑ) ุฑุง ุจู ุนููุงู ูุฑูุฏ ุฏุฑุงูุช ูโฺฉูุฏ ุง ุฏุงุฏูโูุง ุฏุงุฎู ุฎูุฏ ุฑุง ุจุฑูู ูโุฏูุฏุ **ฺฉ ฺฉูพ ุงุฒ ุขู ุฏุงุฏูโูุง** ุงุฌุงุฏ ูโุดูุฏ ุชุง ุงุตู ุฏุงุฏูโูุง ุฏุฑ ูุนุฑุถ ุชุบุฑ ุชูุณุท ฺฉุฏ ุฎุงุฑุฌ ูุฑุงุฑ ูฺฏุฑุฏ.

ุงู ุงุตู ฺฉ ุงุฒ ุฌูุจูโูุง **Encapsulation** (ูพููุงูโุณุงุฒ ุงุทูุงุนุงุช) ุงุณุช ฺฉู ุฏุฑ ุงุตูู ุทุฑุงุญ OOP ุจุณุงุฑ ุญุงุฆุฒ ุงููุช ุงุณุช.

---

## 2. ฺุฑุง Defensive Copying ููู ุงุณุชุ

ุฏุฑ ุจุฑูุงููโููุณุ ฺฉ ุดุก ุจุงุฏ **ูุงุจู ูพุดโุจู** ู **ุซุงุจุช (Immutable ุฏุฑ ุตูุฑุช ุงูฺฉุงู)** ุจุงุดุฏ. ุงฺฏุฑ ฺฉ ุดุก ุฏุงุฏูโูุง ุฏุงุฎู ุฎูุฏ ุฑุง ูุณุชููุงู ุจู ุจุฑูู ูุดุงู ุฏูุฏ ุง ุจุฏูู ุจุฑุฑุณ ุฏุงุฏูโูุง ูุฑูุฏ ุฑุง ุจูพุฐุฑุฏุ ููฺฉู ุงุณุช:

- ุฏุงุฏูโูุง ุฏุงุฎู ุขู ุจุฏูู ุงุทูุงุน ุขู ุชุบุฑ ฺฉููุฏ.
- ุงู ุชุบุฑุงุช ููุฌุฑ ุจู **ุฑูุชุงุฑูุง ูุงุฎูุงุณุชู** ุง **ุจุงฺฏโูุง ูพููุงู** ุดููุฏ.
- ุงุตูู **Encapsulation** ู **Information Hiding** ููุถ ุดููุฏ.

Defensive Copying ุงู ุฎุทุฑ ุฑุง ฺฉุงูุด ูโุฏูุฏ.

---

## 3. ูุซุงูโูุง ุงุฒ ูุดฺฉูุงุช ุจุฏูู Defensive Copying

```csharp
public class Person
{
    public DateTime[] Birthdays { get; set; }

    public Person(DateTime[] birthdays)
    {
        Birthdays = birthdays; // โ ูุดฺฉู: ุงุฑุฌุงุน ูุณุชูู
    }
}

// ุงุณุชูุงุฏู
var dates = new DateTime[] { new DateTime(2000, 1, 1) };
var person = new Person(dates);

// ุญุงูุง ฺฉุณ ูโุชูุงูุฏ ูุณุชููุงู Birthdays ุฑุง ุชุบุฑ ุฏูุฏ!
person.Birthdays[0] = new DateTime(1900, 1, 1);
```

ุฏุฑ ุงูุฌุงุ `Birthdays` ุงุตู ุขุณุจโูพุฐุฑ ุงุณุช. ูุฑ ุชุบุฑ ุฑู ุขุฑุงู ุฏุฑุงูุช ุง ุจุงุฒฺฏุฑุฏุงูุฏูโุดุฏูุ ุฏุงุฏูโูุง ุฏุงุฎู `Person` ุฑุง ุชุบุฑ ูโุฏูุฏ.

---

## 4. ฺฺฏููู ุฏุฑ C# ุงุฒ Defensive Copying ุงุณุชูุงุฏู ฺฉููุ

### โ ุฏุฑ ุณุงุฒูุฏู (Constructor):

```csharp
public class Person
{
    private readonly DateTime[] _birthdays;

    public Person(DateTime[] birthdays)
    {
        _birthdays = new DateTime[birthdays.Length];
        Array.Copy(birthdays, _birthdays, birthdays.Length); // โ Defensive Copy
    }

    public DateTime[] GetBirthdays()
    {
        return (DateTime[])_birthdays.Clone(); // โ Defensive Copy ููฺฏุงู ุจุงุฒฺฏุดุช
    }
}
```

### โ ุจุง ุงุณุชูุงุฏู ุงุฒ `IReadOnlyList<T>` (ูพุดููุงุฏ ุดุฏู ุฏุฑ .NET):

```csharp
private readonly List<DateTime> _birthdays = new();

public Person(IReadOnlyList<DateTime> birthdays)
{
    _birthdays = new List<DateTime>(birthdays); // Defensive Copy
}

public IReadOnlyList<DateTime> Birthdays => _birthdays.AsReadOnly();
```

ุฏุฑ ุงู ุญุงูุชุ ูุดุชุฑ ููโุชูุงูุฏ ูุณุชููุงู ูุณุช ุฑุง ุชุบุฑ ุฏูุฏุ ู ุดูุง ูู ุงุฒ ุชุบุฑ ูุงุฎูุงุณุชู ูุญุงูุธุช ูโฺฉูุฏ.

---

## 5. ุชูุงูุช ุจู Deep Copy ู Shallow Copy

| ููุน ฺฉูพ | ุชูุถุญ | ููุงุณุจ ุจุฑุง Defensive Copyingุ |
|--------|-------|------------------------------|
| **Shallow Copy** | ููุท ุงุฑุฌุงุนโูุง ุณุทุญ ุงูู ฺฉูพ ูโุดููุฏ. ุงุดุงุก ุฏุงุฎู ููฺูุงู ุงุดุชุฑุงฺฉ ูุณุชูุฏ. | ฺฏุงู ฺฉุงู ุงุณุช (ูุซูุงู ุจุฑุง ุขุฑุงูโูุง ููุฏุงุฑ ูุซู `DateTime[]`) |
| **Deep Copy** | ุชูุงู ุงุดุงุก ุฏุงุฎู ุจู ุตูุฑุช ุจุงุฒฺฏุดุช ฺฉูพ ูโุดููุฏ. | ููุช ุนูุงุตุฑ ุฏุงุฎู **ูุงุจู ุชุบุฑ (mutable)** ูุณุชูุฏุ ุถุฑูุฑ ุงุณุช |

ูุซุงู: ุงฺฏุฑ ุขุฑุงู ุดุงูู ุงุดุงุก ุฏฺฏุฑ ุจุงุดุฏ (ูุซูุงู `List<Customer>` ู `Customer` mutable ุจุงุดุฏ)ุ **Deep Copy** ููฺฉู ุงุณุช ูุงุฒู ุจุงุดุฏ โ ุง ุจูุชุฑ ุงุณุช **Immutable Types** ุงุณุชูุงุฏู ฺฉูุฏ.

> ๐ก ูฺฉุชู: ุฏุฑ C#ุ ุจุฑุง ุงููุงุน **value type** (ูุซู `DateTime`ุ `int`)ุ Shallow Copy ฺฉุงู ุงุณุช. ุงูุง ุจุฑุง **reference type**ุ ุจุงุฏ ุนููโุชุฑ ุจุฑุฑุณ ฺฉุฑุฏ.

---

## 6. ุจูุชุฑู ุฑูุดโูุง (Best Practices)

- ููุดู ููุช ฺฉ **mutable object** ุฑุง ุจู ุนููุงู ูพุงุฑุงูุชุฑ ุฏุฑุงูุช ูโฺฉูุฏุ **Defensive Copy** ุจฺฏุฑุฏ.
- ูุงุฏุงูโุงูุงูฺฉุงู ุงุฒ **immutable types** ุงุณุชูุงุฏู ฺฉูุฏ (ูุซู `ReadOnlyCollection<T>`, `IReadOnlyList<T>`).
- ุจุฑุง ุจุงุฒฺฏุฑุฏุงูุฏู ุฏุงุฏูโูุง ุฏุงุฎูุ ูฺโฺฏุงู ุงุฑุฌุงุน ูุณุชูู ูุฏูุฏ.
- ุงุฒ `readonly` ู `private set` ุจุฑุง ููุฏูุง ุงุณุชูุงุฏู ฺฉูุฏ.
- ุงฺฏุฑ ฺฉูุงุณ ุดูุง ุจุงุฏ **immutable** ุจุงุดุฏุ ุชูุงู ููุฏูุง ุจุงุฏ ููุทโุฎูุงูุฏู ู immutable ุจุงุดูุฏ.

---

## 7. ูุญุฏูุฏุชโูุง ู ูุฒููโูุง

- **ูุฒูู ุญุงูุธู ู ุนููฺฉุฑุฏ**: ูุฑ ุจุงุฑ ฺฉูพ ฺฉุฑุฏู ุญุงูุธู ูุตุฑู ูโุดูุฏ.
- **ูพฺุฏฺฏ**: ุฏุฑ ุตูุฑุช ุฏุงุฏูโูุง ูพฺุฏูุ ูุงุฒ ุจู Deep Copy ุจุงุนุซ ุงูุฒุงุด ูพฺุฏฺฏ ูโุดูุฏ.
- **ุชุนุงุฏู**: ููุดู ูุงุฒ ุจู Defensive Copy ูุณุช. ุงฺฏุฑ ูุทูุฆู ูุณุชุฏ ฺฉู ุตุฏุงฺฉููุฏู ฺฉุฏ ุดูุง ูุงุจู ุงุนุชูุงุฏ ุงุณุช (ูุซูุงู ุฏุงุฎู ููุงู ุงุณูุจู)ุ ููฺฉู ุงุณุช ุบุฑุถุฑูุฑ ุจุงุดุฏ.

ุงูุง ุฏุฑ ฺฉุชุงุจุฎุงููโูุง ุนููู ุง ฺฉุฏูุง ฺฉู ุจุง ฺฉุฏ ุฎุงุฑุฌ ฺฉุงุฑ ูโฺฉููุฏุ **Defensive Copying ุชูุตู ูโุดูุฏ**.

---

## 8. ุฌูุนโุจูุฏ

- Defensive Copying ฺฉ **ุฏูุงุน ุฏุฑ ุนูู** ุจุฑุง ุญูุธ **ุณูุงูุช ุงุดุงุก** ุงุณุช.
- ุงู ุชฺฉูฺฉ ูุณุชููุงู ุงุฒ ุงุตู **Encapsulation** ูพุดุชุจุงู ูโฺฉูุฏ.
- ุฏุฑ C#ุ ุจุง ุงุณุชูุงุฏู ุงุฒ `Array.Clone()`, `new List<T>(original)`, ุง ุจุงุฒฺฏุฑุฏุงูุฏู `ReadOnly` wrappers ูโุชูุงู ุขู ุฑุง ูพุงุฏูโุณุงุฒ ฺฉุฑุฏ.
- ููุดู ุจู **ุงููุช** ู **ฺฉุงุฑุง** ุชุนุงุฏู ุจุฑูุฑุงุฑ ฺฉูุฏ.

---

## 9. ููุงุจุน ูุนุชุจุฑ

1. **Microsoft Learn โ Guidelines for Defensive Copying**  
   ๐ [https://learn.microsoft.com/en-us/dotnet/standard/design-guidelines/defensive-copying](https://learn.microsoft.com/en-us/dotnet/standard/design-guidelines/defensive-copying)

2. **"Effective C#: 50 Specific Ways to Improve Your C#" โ Bill Wagner**  
   ๐น ูุตู 10: *Prefer Immutable Data Types*  
   ๐น ูุตู 20: *Avoid Returning References to Internal Class Data*

3. **"Framework Design Guidelines" โ Krzysztof Cwalina & Brad Abrams**  
   ๐ [https://learn.microsoft.com/en-us/dotnet/standard/design-guidelines/](https://learn.microsoft.com/en-us/dotnet/standard/design-guidelines/)

4. **C# in Depth โ Jon Skeet**  
   (ุฏุฑ ููุฑุฏ Immutable Types ู ุงููุช ุฏุงุฏู)

5. **Stack Overflow โ Defensive Copying in C#**  
   ๐ [https://stackoverflow.com/questions/32871348/defensive-copying-in-c-sharp](https://stackoverflow.com/questions/32871348/defensive-copying-in-c-sharp)

